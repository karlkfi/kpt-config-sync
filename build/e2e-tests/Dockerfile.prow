# Dockerfile for the prow test environment

# We'd use the kubekins-e2e straight away, but it's missing the 'kind' binary.
# Ensure versions in this file match those in Makefile.prow.
ARG KUBEKINS="v20200813-1642133-1.19"


FROM golang:1.14.2-alpine AS build-base
RUN apk add bash ca-certificates coreutils git gcc g++ libc-dev unzip

ENV GO111MODULE=on
# Build static binaries only.
ENV CGO_ENABLED=0

# kind can run kubernetes clusters in docker
# v0.10.0
ARG KIND_RELEASE="v0.10.0"
# go get automatically installs targets
RUN go get -u sigs.k8s.io/kind@${KIND_RELEASE}

ARG KUBEKINS
FROM gcr.io/gke-test-infra/kubekins-e2e:${KUBEKINS}
COPY --from=build-base /go/bin/ /bin/
